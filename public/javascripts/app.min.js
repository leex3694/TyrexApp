/*! TYREX_APP 2015-11-06 */
var app=angular.module("myApp",[]);app.controller("FormController",["$scope","$http",function(a,b){function c(a){b({method:"POST",url:"/formRouter/postDeviceQuantities",data:a})}function d(a){b({method:"POST",url:"/formRouter/postTotalsInServer",data:a})}function e(){return b({method:"GET",url:"/formRouter/getresult"})}function f(a){var b=a.toString().split(".");return b[0]=b[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),b.join(".")}function g(){var b=Math.round(q*w);a.PotentialDistBed=f(b);var c=Math.round(q*x);a.potentialDistDeviceExtraction=f(c);var d=Math.round(q*y);a.potentialDistDeviceReplacement=f(d);var e=Math.round(q*z);a.potentialCostDistAntibiotics=f(e);var g=Math.round(1*q);a.totalPotentialCostDist=f(g)}function h(){b({method:"GET",url:"/formRouter/getCostValues"}).then(function(a){var b=a.data[0];A=b.PMCost,B=b.CRTPCost,C=b.ICDCost,D=b.CRTDCost})}function i(b){return null==b||""===b?a.PMNumImplants=0:a.PMNumImplants=a.PMNumImplantsInput,a.PMNumImplants}function j(b){return null==b||""===b?a.CRTPNumImplants=0:a.CRTPNumImplants=a.CRTPNumImplantsInput,a.CRTPNumImplants}function k(b){return null==b||""===b?a.ICDNumImplants=0:a.ICDNumImplants=a.ICDNumImplantsInput,a.ICDNumImplants}function l(b){return null==b||""===b?a.CRTDNumImplants=0:a.CRTDNumImplants=a.CRTDNumImplantsInput,a.CRTDNumImplants}function m(b){return null==b||""===b?a.PMCost=A:a.PMCost=a.PMCostInput,console.log(a.PMCostInput),a.PMCost}function n(b){return null==b||""===b?a.CRTPCost=B:a.CRTPCost=a.CRTPCostInput,a.CRTPCost}function o(b){return null==b||""===b?a.ICDCost=C:a.ICDCost=a.ICDCostInput,a.ICDCost}function p(b){return null==b||""===b?a.CRTDCost=D:a.CRTDCost=a.CRTDCostInput,a.CRTDCost}a.hideAndShowBox=!1,a.showFirstTotals=!1,a.showTotalPotentials=!1,a.showAvgRelatedInfection=!1,a.inputBoxHide=!0,a.hidePercentageValues=!0,a.showtotalImplantsAndCost=!1;var q;a.placeNewPotentialHighRisk=40,a.placeNewAvgInfectionRate=3.6,a.submitData=function(){function h(){return b({method:"GET",url:"/formRouter/getDeviceQuantities"})}function r(){h().then(function(a){s(a),g()},function(a){console.log(a)})}function s(b){a.totalNumImplants=b.data,a.TotalPotentialHighRisk=Math.round(a.totalNumImplants*H),q=Math.round(a.TotalAverageInfectionRate*J),a.TotalCostInfectionWithoutTyrx=f(q);var c=Math.round(K*a.TotalPotentialHighRisk*J);a.costInfectionWithTyrx=f(c);var d=I*a.TotalPotentialHighRisk;a.costOfTYRXInHighRiskPatients=f(d);var e=c+d;a.totalCostInfectionAndTyrex=f(e);var h=e-q;a.economicImpact=f(h),g(b)}function t(){H=a.placeNewPotentialHighRisk/100,a.PMPotentialHighRisk=Math.round(F.PMQuantity*H),a.CRTPPotentialHighRisk=Math.round(F.CRTPQuantity*H),a.ICDPotentialHighRisk=Math.round(F.ICDQuantity*H),a.CRTDPotentialHighRisk=Math.round(F.CRTDQuantity*H)}function u(){var b=a.placeNewAvgInfectionRate/100;a.PMDeviceInfection=a.PMPotentialHighRisk*b,a.CRTPDeviceInfection=a.CRTPPotentialHighRisk*b,a.ICDDeviceInfection=a.ICDPotentialHighRisk*b,a.CRTDDeviceInfection=a.CRTDPotentialHighRisk*b,a.TotalAverageInfectionRate=Math.ceil(a.PMDeviceInfection+a.CRTPDeviceInfection+a.ICDDeviceInfection+a.CRTDDeviceInfection),a.PatientMortality=Math.ceil(a.TotalAverageInfectionRate/2)}function v(b){return I="undefined"===b||null==b?1e3:a.tyrxPrice}console.log("heyhey"),a.hideAndShowBox=!0,a.showFirstTotals=!0,a.showTotalPotentials=!0,a.showAvgRelatedInfection=!0,a.inputBoxHide=!1,a.showtotalImplantsAndCost=!0,a.editInputs=function(){a.hideAndShowBox=!1,a.inputBoxHide=!0};var w=a.PMNumImplantsInput;a.PMNumImplants=i(w);var x=a.CRTPNumImplantsInput;a.CRTPNumImplants=j(x);var y=a.ICDNumImplantsInput;a.ICDNumImplants=k(y);var z=a.CRTDNumImplantsInput;a.CRTDNumImplants=l(z);var A=a.PMCostInput;a.PMCost=m(A);var B=a.CRTPCostInput;a.CRTPCost=n(B);var C=a.ICDCostInput;a.ICDCost=o(C);var D=a.CRTDCostInput;a.CRTDCost=p(D);var E={PMCost:a.PMCost,CRTPCost:a.CRTPCost,ICDCost:a.ICDCost,CRTDCost:a.CRTDCost};d(E);var F={PMQuantity:a.PMNumImplants,CRTPQuantity:a.CRTPNumImplants,ICDQuantity:a.ICDNumImplants,CRTDQuantity:a.CRTDNumImplants},G=e();G.then(function(b){costData=b.data,a.totalDevicesCost=costData,console.log(a.totalDevicesCost)},function(a){console.log(a)}),h(),c(F),r();var H;t(),u();var I,J=42076.27,K=.0044,L=a.tyrxPrice;v(L);v(L),console.log("why??????")};var r=17761.4;a.patientBedCost=f(r);var s=3450.32;a.deviceExtractionCost=f(s);var t=60187.24;a.deviceReplacementCost=f(t);var u=829.29;a.antibioticsCost=f(u);var v=(r+s+t+u).toFixed(2);a.totalCostsExample=f(v),a.weightedBedOccupancy=Math.round(r/v*100);var w=r/v,x=s/v,y=t/v,z=u/v;a.showInfectionInput=!1,a.changePotentialHighRisk=function(){a.showHighRiskInputButton=!0},a.submitNewPotentialRisk=function(){function b(b){return"undefined"==b||null==b?a.placeNewPotentialHighRisk=40:a.placeNewPotentialHighRisk=b,b}var c=a.updatePotentialHighRisk;b(c),a.showHighRiskInputButton=!1},a.changeAvgInfectionRate=function(){a.showInfectionInputButton=!0},a.submitNewAvgInfectionRate=function(){function b(b){return"undefined"==b||null==b?a.placeNewAvgInfectionRate=3.6:a.placeNewAvgInfectionRate=b,b}var c=a.updateAvgInfectionRate;b(c),a.showInfectionInputButton=!1};var A,B,C,D;h()}]);